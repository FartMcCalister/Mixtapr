<!DOCTYPE html><html class="" lang=""><head><script type="text/javascript" class="silex-json-styles" data-silex-static="">
    window.silex = window.silex || {}
    window.silex.data = {"site":{"width":1200},"pages":[{"id":"page-page-1","displayName":"Page 1","link":{"linkType":"LinkTypePage","href":"#!page-page-1"},"canDelete":true,"canProperties":true,"canMove":true,"canRename":true,"opened":false}]}</script>
    <meta charset="UTF-8">
    <!-- generator meta tag -->
    <!-- leave this for stats and Silex version check -->
    <meta name="generator" content="Silex v2.2.12">
    <!-- End of generator meta tag -->
    <script type="text/javascript" src="http://localhost:6805/static/2.11/jquery.js" data-silex-static=""></script>
    <script type="text/javascript" src="http://localhost:6805/static/2.11/jquery-ui.js" data-silex-static="" data-silex-remove-publish=""></script>
    <script type="text/javascript" src="http://localhost:6805/static/2.11/pageable.js" data-silex-static="" data-silex-remove-publish=""></script>
    <script type="text/javascript" src="http://localhost:6805/static/2.11/front-end.js" data-silex-static=""></script>
    <link rel="stylesheet" href="http://localhost:6805/static/2.11/normalize.css" data-silex-static="">
    <link rel="stylesheet" href="http://localhost:6805/static/2.11/front-end.css" data-silex-static="">

    <style type="text/css" class="silex-style">html {margin: 0; padding: 0; height: 100%;}body {background-color: #3a3a3a; background-repeat: repeat-x; margin: 0; padding: 0; height: 100%;}.padded10 {margin-top: 10px; margin-bottom: 10px;}.splitSection {width: 975px; padding: 5px; margin: 20px 5px 5px 5px; min-height: 400px;}#fileListSection th:first-of-type + th {text-align: left;}#fileListSection td:first-of-type + td, #fileListSection th:first-of-type + th {min-width: 400px;}#fileListSection td:first-of-type {min-width: 20px; max-width: 20px;}#fileListSection td:first-of-type + td + td {min-width: 50px; text-align: right;}#fileListSection td:first-of-type + td + td + td {min-width: 50px; text-align: right;}#resultSideA {max-width: 455px; float: left; min-height: 250px;}#resultSideB {max-width: 455px; float: right; min-height: 250px;}.trackListingTable td:first-of-type, .trackListingTable th:first-of-type {min-width: 40px; max-width: 40px;}.trackListingTable th:first-of-type + th {text-align: left;}.trackListingTable td:first-of-type + td, .trackListingTable th:first-of-type + th {min-width: 340px; max-width: 340px; overflow: hidden; white-space: nowrap; text-overflow: ellipsis;}.trackListingTable td:first-of-type + td + td {min-width: 50px; text-align: right;}.upArrow {}.downArrow {}#optimize {margin: 20px; padding: 5px 20px; color: blue;}.xButton {font-weight: bold; color: red; font-size: 11px; width: 23px;}.playButton {font-weight: bold; color: green; font-size: 11px;}.tapelogo {image-rendering: pixelated; position: absolute; top: 62px; margin-left: 845px;}.timer {position: relative; bottom: 5px; left: 15px;}.tapeControls {float: right; margin-right: 50px; margin-top: 5px;}#tapeSizeBar {}#tapeFilledBar {}.progressBar {height: 15px; width: 300px; padding: 2px; background-color: #ffffff; border: 2px solid black; float: left; margin-top: 5px; margin-bottom: 15px;}.filledBar {height: 15px; width: 0px; background-color: #f2166a;}.barPosition {width: 2px; height: 22px; background-color: black; float: left; margin-top: -6px;}@media (pointer:none), (pointer:coarse) {.forceLeft {display: none;}.titles {margin: 0 auto; width: 90%;}.centerimg {display: block; margin-left: auto; margin-right: auto; width: 98%;}.wrapper {min-width: 1273px;}.wplist ul {width: initial !important;}}.forceLeft {opacity: 65%;}.titles {padding-left: 272px;}.section {margin: 20px 5px 5px 5px !important;}.titles {}.section.wp {}.wp a:link {color: #3000cd;}.wp a:visited {color: #3000cd;}.colorpicker {width: 75px; height: 25px; margin-top: 5px;}.bannertext {padding-top: 30px; text-align: center; height: 80px;}.bannerdesc {text-align: center; color: #16161d;}.wptitle {font-size: 200%; font-weight: bold; padding-left: 10px; padding-top: 5px;}.wpdesc {width: 95%; font-size: 100%; padding-left: 15px; padding-top: 7px; padding-bottom: 7px; font-family: monospace;}.wplist {font-size: 150%; font-family: monospace; font-weight: bold; margin: 0 auto;}.wplist a:link {color: #3888d0; text-decoration: none;}.wplist a:hover {color: #FFDD00; text-decoration: none;}.wplist li {padding-top: 100px; padding-bottom: 200px;}.wplist ul {padding-left: 0; list-style-type: none; width: 1400px; margin: 0 auto;}.wpimg {padding-left: 25px;}.centerimg {display: block; margin-left: auto; margin-right: auto; width: 95%;}.wplabel {width: 23%; background-color: grey; margin-bottom: 5px; padding-left: 4px;}select[disabled] {pointer-events: none;}.content {padding-bottom: 100px; padding-top: 30px;}.footer {height: 85px; position: absolute; bottom: 0px; left: 0px; font-family: monospace; width: 100%; min-width: 1273px; margin-top: 61px; background: linear-gradient(#7d7d7d, #444444);}.footer > div {width: 975px; margin-left: 270px;}.footer > div > .dcopelogo {position: absolute; left: 1170px; top: 29px;}.footer div div:first-of-type {font-weight: bold; margin-bottom: 3px; padding-left: 3px;}.footer div div:first-of-type +div {font-weight: bold; font-size: 85%; margin-bottom: 3px; padding-left: 15px; font-family: monospace;}.footer div div:first-of-type +div + div {font-weight: bold; font-size: 90%; padding-left: 40px;}.wrapper {min-height: 100%; position: relative;}.mask > div {z-index: 5; position: absolute; background: black; opacity: 0.6; top: 0; bottom: 0; left: 0; right: 0;}.mask .masktop {top: 0; left: 0; right: 0;}.mask .maskleft {top: 0; bottom: 0; left: 0;}.mask .maskright {top: 0; bottom: 0; right: 0;}.mask .maskbottom {bottom: 0; left: 0; right: 0;}#loadingBox {z-index: 5; position: absolute; background: black; opacity: 0.6; top: 0; bottom: 0; left: 0; right: 0;}.mouseOverHighlight {color: blue; background-color: #92ffe4;}.mouseOverHighlight.red {color: red; background-color: #fff058;}.hl, .hl > td {z-index: 6; position: relative; background-color: inherit;}.overlay {z-index: 5; position: fixed; background: black; opacity: 0.6; top: 0; bottom: 0; left: 0; right: 0;}.popup {z-index: 7; position: fixed; background: white; opacity: 0.9; top: 199px; right: 15px; width: 595px; border-radius: 3px;}.helpTitle {font-weight: bold; font-size: 150%; padding: 20px; color: #1f475a;}.helpContent {padding-left: 20px; padding-right: 20px; padding-bottom: 20px; color: #1f475a;}.blockTypePopup {z-index: 7; position: fixed; background: white; opacity: 0.9; top: 210px; left: 500px; width: 595px; height: 315px; border-radius: 3px; text-align: center; border-color: #FFCC00; border-style: solid; border-width: 4px;}.deletePopup {z-index: 7; position: fixed; background: white; opacity: 0.9; top: 210px; left: 500px; width: 595px; height: 250px; border-radius: 3px; text-align: center; border-color: red; border-style: solid; border-width: 4px;}.deleteTitle {font-weight: bold; font-size: 150%; padding: 20px; color: black;}.deleteContent {font-weight: bold; padding-left: 20px; padding-right: 20px; padding-bottom: 15px; color: black;}.confirmDelete {text-align: center; padding-top: 15px; padding-bottom: 15px;}.actualDeleteButton {color: red; font-size: 150%; width: 60%; border-color: red;}.cancelDeleteButton {color: blue; font-size: 150%; width: 60%; border-color: blue;}.helpX {position: absolute; top: 0px; right: 4px; font-weight: bold; font-size: 150%; color: black;}#stage1 {background-color: inherit;}.section {padding: 5px; margin: 0 auto; border: 1px; border-style: solid; border-radius: 3px; border-color: #000000; background-color: #cecece; width: 975px; font-family: sans-serif; box-shadow: 2px 3px 11px -3px #000000; margin-top: 20px;}.section:first-of-type {margin-top: 24px;}.data_table td:first-of-type {padding: 3px; text-align: center; width: 50px;}.data_table td:first-of-type + td {padding: 3px; text-align: right; width: 201px;}.data_table td:first-of-type + td + td {padding: 3px; text-align: center; width: 150px;}.data_table td:first-of-type + td + td + td, .data_table td:first-of-type + td + td + td + td {padding: 3px; width: 151px; font-size: 90%; cursor: default; color: grey; text-align: left;}.table_labels {font-weight: bold; padding: 1px 10px; cursor: default;}.inputbox {width: 150px;}.inputbox[type=checkbox] {width: 50px;}#result {font-size: 120%; min-height: 23px;}table {border-collapse: collapse;}table, th, tr, td {}td:first-of-type {width: 150px;}td:first-of-type > div {width: 150px; text-overflow: ellipsis; overflow: hidden; white-space: nowrap;}td:first-of-type + td + td {min-width: 132px;}td:first-of-type + td input[type="text"], input.multiselect {width: 66px;}.helpboxdata {position: absolute; min-width: 350px; min-height: 200px; background-color: #fdfdfd; text-align: left; border: 1px solid #7A9CD3; left: -386px; opacity: 0.95; top: 76px; z-index: 2;}.multiselectdata {position: absolute; min-width: 68px; margin-left: 42px; background-color: #fdfdfd; text-align: left; border: 1px solid #7A9CD3;}.propertyset .multiselectdata {margin-left: 59px;}.blocktable {min-width: 606px;}.blocktable td.multiselectdata {width: 147px; background-color: #fdfdfd; text-align: left;}.blocktable .multiselectdata .multiselectOption {width: 100%; text-align: left; font-weight: initial; color: black; font-size: 100%; height: initial; line-height: initial; cursor: default;}.blocktable .multiselectdata .multiselectOption {height: 15px; font: 13.3333px Arial; -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none;}.blocktable .multiselectdata .multiselectOption.selected {color: white; background-color: #328EFE;}.blocktable .multiselectdata .multiselectOption:hover {color: white; background-color: #227EFE;}.checkboxbutton, .resultsetbutton {color: #5f5f5f; font-size: 90%; height: 21px; line-height: 1px; padding: 0px 6px;}button {font-weight: bold; font-size: 130%;}.selected {color: blue; border-color: blue;}.invalidproduct > td {background-color: #e0e0e0; color: #c0c0c0;}.invalidproduct > td > button.selected {color: #8f8f8f; border-color: grey;}button.invalidproduct {color: #8f8f8f; border-color: grey;}#copy, #generate {margin-top: 10px; margin-left: 5px; width: 285px; display: block;}#copy {color: #0041FF;}.signed {width: 127px; float: right;}.sign {font-weight: bold; text-align: center; float: left; padding-top: 2px; width: 17px; height: 17px; color: blue; -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none;}.red {color: red;}.orange {color: orange;}.green {color: green;}.blue {color: blue;}.grey {color: grey;}.small {font-size: 85%;}.medium {font-size: 165%;}.large {font-size: 200%;}.giant {font-size: 400%;}.bold {font-weight: bold;}.center {text-align: center;}.left {float: left;}.right {float: right;}.major {background-color: #FFFFFF; font-weight: bold;}.unselectable, button, .darkrow {-webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; cursor: default;}ul {padding-left: 30px; margin-bottom: 20px;}li {margin-top: 5px; margin-bottom: 5px;}.deleteButton {width: 70px; font-size: 80%; margin-right: 4px;}.deleteButton:hover {color: red;}.removeButton {float: right; margin-top: 25px; padding: 2px;}.appendButton:hover, .firstBlockButton:hover {color: #41CA4F;}.buttonlabel {width: 50px; padding-left: 1.3px; padding-right: 4px; display: inline-block;}.appendButton {width: 145px; font-size: 80%; display: inline-block; margin-right: 4px;}.firstBlockButton {width: 145px; font-size: 80%; display: inline-block; margin-right: 4px;}.newchunk {padding: 2px; width: 173px; margin: 0px 25px; margin-top: 6px; background-color: inherit;}.logicblock {padding-top: 8px; margin-bottom: 12px; background-color: inherit;}.headerButtons {padding-bottom: 12px; background-color: inherit;}.addButton {padding-top: 1px; background-color: #e9fdff; margin-top: 6px;}.resultsection {margin-bottom: 100px;}.copysection {width: 100%; height: 30px; padding-bottom: 12px;}.disabled {color: #D8D8D8;}.colorbox {width: 40px;}.save input {width: 116px;}input.blockname, input.groupname {width: 188px;}.blockname, .groupname, .blockmenu {}.blockheaderspan {float: right; margin-right: 275px;}.blockheader {min-width: 603px; background-color: #8cbcd2; font-weight: bold; padding-left: 2px;}.show, .hide {margin: 0 auto; font-weight: bold; color: blue;}.preinstructions {width: 670px; margin: auto; font-size: 120%; margin-top: 10px;}.instructions {font-size: 120%; position: absolute; top: 137px; left: 724px;}.instructions > div {font-weight: bold; margin: 10px auto; font-size: 125%;}.mono {font-family: monospace;}select {height: 21px;}.chunkpreview {height: 15px; font-weight: bold; font-size: 70%; color: #FFFFFF; background-color: #8cbcd2;}.logic {max-width: 602px; background-color: #8cbcd2; padding: 2px; font-weight: bold;}.blockoptions {max-width: 602px; background-color: #8cbcd2; padding: 2px; font-weight: bold;}.fieldvalue select {width: 70px;}.darkrow {background: #8cbcd2;}.hideshow {float: right; text-align: right; font-size: 80%; -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; cursor: default;}.hideshow:hover {color: blue;}.save {float: right;}.help0 {margin-bottom: 20px;}.sidebyside {height: 146px;}.loadsection {float: right; height: 100%; width: 250px; margin-top: 5px; margin-right: 5px;}#load {width: 246px;}.load {margin-top: 7px;}.load button {margin-left: 10px;}.orsection {float: left; margin-top: 45px; margin-left: 160px;}.new {position: relative; height: 58px;}.new button {float: left; position: absolute; bottom: 0; left: 35px;}.newsection {float: left; height: 100%; width: 280px; margin-top: 5px; margin-left: 5px;}.sectiontitle {margin-top: 5px; margin-left: 5px;}.propertyset textarea {margin-bottom: -6px; min-width: 386px; min-height: 121px; position: absolute; top: 0px; max-width: 386px; max-height: 121px;}.propertyset textarea:focus {max-width: none; max-height: none;}.textareaparent {height: 125px; position: relative;}label.inlineblock {width: 37px; text-align: center; color: blue;}.inlineblock {display: inline-block;}.inlineblock .multiselectdata {margin-left: 0px;}.transfer {margin-right: 20px;}.transfer button {width: 52px;}label.tolabel {margin: 0px 3px; text-align: center;}.logic .logicButtonSmall button {width: 40px;}.logic .logicButtonLarge button {width: 82px;}.thisGridButton, .allowMissingBlocks {width: 221px;}.thisGridName {width: 91px; margin-left: 5px;}.settings {height: 400px; background-color: inherit;}.settings div {float: right; margin-top: 5px; width: 100%;}.settings > div:first-of-type {float: inherit;}.settingslabel {float: left;}.forceLeft {position: fixed; top: 4px; margin: 0; width: 250px;}.forceLeft .section {width: 250px; margin: 20px 0 0 0 !important;}.pseudocode div {font-weight: bold; font-size: 60%;}.pseudocode div:first-of-type {font-size: 100%;}.infolink:after {content: '?'; display: inline-block; font-family: sans-serif; font-weight: bold; text-align: center; width: 1.8ex; height: 1.8ex; font-size: 1.4ex; line-height: 1.9ex; border-radius: 1.2ex; margin-right: 4px; margin-left: 4px; padding: 1px; color: blue; background: white; border: 1px solid blue; text-decoration: none;}.infolink:hover:before {color: white; background: blue; border-color: white; text-decoration: none;}.errors {position: relative; color: #f74343; left: 1000px; height: 0px; width: 0px; white-space: nowrap;}.errorsection {color: red; margin-left: 15px; margin-top: 5px;}.version {color: #4064b3; position: absolute; top: 139px; left: 1161px; white-space: nowrap;}.precision {width: 45px; margin-right: 4px;}.precisionspan {float: right; margin-right: 2px;}.section.topbanner {margin-top: 0px !important; padding-top: 0px !important;}.banner {margin-left: -6px; margin-top: -6px; height: 148px;}.dcopelogo {position: absolute; top: 42px; margin-left: 14px;}a:link {color: #4064b3;}a:visited {color: #4064b3;}a:hover {color: #4064b3;}a:active {color: #4064b3;}a:link {text-decoration: none;}a:visited {text-decoration: none;}a:hover {text-decoration: underline;}a:active {text-decoration: underline;}.footer a:link {color: #0006ff;}.footer a:visited {color: #0006ff;}.footer a:hover {color: #FFDD00;}.footer a:active {color: #FFDD00;}</style>
    <script type="text/javascript" class="silex-script">$(document).ready(function(){
  $('#results').hide();
  $('#optimize').hide();
  
  /*document.getElementById('fileInput').addEventListener('change', function(){

    // Obtain the uploaded file, you can change the logic if you are working with multiupload
    var file = this.files[0];
    
    // Create instance of FileReader
    var reader = new FileReader();

    // When the file has been succesfully read
    reader.onload = function (event) {

      // Create an instance of AudioContext
      var audioContext = new (window.AudioContext || window.webkitAudioContext)();

      // Asynchronously decode audio file data contained in an ArrayBuffer.
      audioContext.decodeAudioData(event.target.result, function(buffer) {
        // Obtain the duration in seconds of the audio file (with milliseconds as well, a float value)
        var duration = buffer.duration;

        // example 12.3234 seconds
        //console.log("The duration of the song is " + duration + " seconds");
        // Alternatively, just display the integer value with
        // parseInt(duration)
        // 12 seconds
      });
    };

    // In case that the file couldn't be read
    reader.onerror = function (event) {
      console.error("An error ocurred reading the file: ", event);
    };

    // Read file as an ArrayBuffer, important !
    reader.readAsArrayBuffer(file);
  }, false);*/
  
  
  function Track (file) {
    this.file = file;
    this.name = file.name.replace(/\.[A-Za-z0-9]+$/, '');
    this.duration = 0.0;
    //this.title = "";
    
    populateMetaData(this);
  }
  
  var audioFiles = [];
  var secondsSideA = parseInt($('#minutesSideA').val()*100) * 60 / 100;
  var secondsSideB = parseInt($('#minutesSideA').val()*100) * 60 / 100;
  var secondsSilence = 0;
  var minimumSilence = 0.1;  // minimum 0.1s delay between songs for fixing timing inaccuracies
  var secondsPaddingStart = 0;
  var secondsPaddingEnd = 0;
  var solutionThreshold = 2;
  
  var bestSolution = new Solution();
  var ignoreStupidSolutions = true;
  var maxTrackCount = 0;
  var minTrackCount = 0;
  
  var audioElement = document.createElement('audio');
  var currentlyPlaying = -1;
  
  var isPlayingSide = false; // true when playing whole side
  var currentSide = "";      // A or B when playing a side, empty when not playing
  var currentTrack = 0;      // increments by 1 for each track played when playing whole side
  var currentFillWidth = 0;  // number of pixels for the width of the filled side being played now
  var startTime = 0;         // stores start time of playing side
  var sideA = [];            // list of tracks on side A
  var sideB = [];            // list of tracks on side B
  var sideTracks = [];       // set to list of current tracks (either A or B)
  var timesSideA = [];       // start times of tracks A
  var timesSideB = [];       // start times of tracks B
  var times = [];            // start times of current tracks (either A or B)
  var currentTimeOffset = 0; // difference in current position vs expected position, used to tweak wait times between songs
  var endTimeA = 0;          // seconds after start that side A should end
  var endTimeB = 0;          // seconds after start that side B should end
  var endTime = 0;           // seconds after start that played side should end
  
  
  // uploads all files selected in the file chooser
  // does not remove existing files
  // does not add duplicate files
  upload = function () {
    // clear list of files
    //audioFiles = [];
    
    var fileInput = $('#fileInput')[0];

    // files is a FileList object (similar to NodeList)
    var files = fileInput.files;

    // loop through files
    for (var i = 0; i < files.length; i++) {
      addFile(files[i]);
    }
    
    refreshDisplayedFiles();
  };
  
  // adds a file to the list if not already there
  addFile = function (file) {
	if(file.type.startsWith('audio/')) {
		console.log("Uploading: " + file.name);
    //if(file.type == "audio/wav" || file.type == "audio/mpeg" || file.type == "audio/flac" || file.type == "audio/x-flac") {
      if(!hasTrack(file)) {
        audioFiles.push(new Track(file));
      }
      else {
        console.log("Skipping upload of duplicate track: " + file.name);
      }
    }
  };
  
  // returns true if there is already a file in the list with the same file name
  hasTrack = function (file) {
    var found = false;
    $.each(audioFiles, function (i, data) {
      if(data.file.name == file.name) {
        found = true;
      }
    });
    return found;
  };
  
  // removes an uploaded track by index
  // hides solution
  // TODO: see if possible to preserve solution if removed track wasn't used
  removeTrack = function (index) {
    audioFiles.splice(index, 1);
    refreshDisplayedFiles();
    clearSolution();
    $('#results').hide();
  };
  
  // builds the list of files
  refreshDisplayedFiles = function () {
    $('#fileListSection').empty();
    var header = "<tr><th></th><th>Track Name</th><th>Duration</th><th></th><th></th></tr>";
    $('#fileListSection').append(header);
    
    var readyToOptimize = true;
    
    $.each(audioFiles, function (i, data) {
      if(data.duration == 0) {
        readyToOptimize = false;
      }
      var dur = formatTimeDecimal(data.duration);
      var remove = "<button class='xButton' onclick='removeTrack("+i+")'>X</button>";
      var row = "<tr><td id='control"+i+"'>"+buildPlayButtonImage(i)+"</td><td>"+data.name+"</td><td>"+dur+"</td><td>"+remove+"</td></tr>";
      $('#fileListSection').append(row);
    });
    
    if(audioFiles.length > 0 && readyToOptimize) {
      $('#optimize').show();
    }
    else {
      $('#optimize').hide();
    }
  };
  
  /*
  var optimizeCheck = setInterval(function () {
    if($('#fileListSection').is(':visible') && !isPlayingSide) {
      if(audioFiles.length > 0) {
        var uninitializedFiles = false;
        $.each(audioFiles, function (i, data) {
          if(data.duration == 0 || data.duration == null) {
            // some file not initialized yet
            uninitializedFiles = true;
          }
        });
        if(!uninitializedFiles) {
          // all files are initialized
          $('#optimize').show();
        }
        else {
          // at least one file not yet initialized
          $('#optimize').hide();
        }
      }
      else {
        // no files to optimize yet
        $('#optimize').hide();
      }
    }
  }, 1000);*/
  
  // common function to build the image button that changes from play to stop for each track
  buildPlayButtonImage = function (index) {
    return "<img src='play_button_green3.png' alt='play' onclick='clickPlayTrack("+index+");' style='padding-top:3px;width:15px;height:15px;'>";
  };
  
  // common function to build the image button that changes from play to stop for each track
  buildStopButtonImage = function (index) {
    return "<img src='stop_button_red3.png' alt='stop' onclick='clickStopPlaying();' style='padding-top:3px;width:15px;height:15px;'>";
  };
  
  buildUpArrowImage = function (index, invisible) {
    return "<img src='up_arrow3.png' alt='up' onclick='moveTrackUp("+index+")' style='padding-top:3px;width:15px;height:15px;"+(invisible?"opacity:0;":"")+"'>";
  };
  
  buildDownArrowImage = function (index, invisible) {
    return "<img src='down_arrow3.png' alt='up' onclick='moveTrackDown("+index+")' style='padding-top:3px;width:15px;height:15px;"+(invisible?"opacity:0;":"")+"'>";
  };
  
  populateMetaData = function (track) {
    // Create instance of FileReader
    var reader = new FileReader();

    // When the file has been succesfully read
    reader.onload = function (event) {

      // Create an instance of AudioContext
      var audioContext = new (window.AudioContext || window.webkitAudioContext)();

      // Asynchronously decode audio file data contained in an ArrayBuffer.
      audioContext.decodeAudioData(event.target.result, function(buffer) {
        // Obtain the duration in seconds of the audio file (with milliseconds as well, a float value)
        var duration = buffer.duration;
        
        track.duration = duration;
        refreshDisplayedFiles();
        
        //var metadata = AudioMetadata.ogg(event.target.result);
        //track.title = metadata.title;
        //refreshDisplayedFiles();

        // example 12.3234 seconds
        // console.log("The duration of the song is " + duration + " seconds");
        // Alternatively, just display the integer value with
        // parseInt(duration)
        // 12 seconds
      });
    };
    
    // Read in the file which triggers the onload above
    reader.readAsArrayBuffer(track.file);
  };
  
  formatTime = function (seconds) {
    var pad = "";
    if(Math.round(seconds % 60) < 10) {
      pad = "0";
    }
    return Math.floor(seconds / 60) + ":" + pad + Math.round(seconds % 60);
  };
  
  formatTimeDecimal = function (seconds) {
    var pad = "";
    var decimalPad = "";
    var minutes = Math.floor(seconds / 60);
    var roundedSeconds = Math.round((seconds % 60) * 100)/100;
    if(roundedSeconds == 60) {
      roundedSeconds = 0;
      minutes++;
    }
    if(roundedSeconds < 10) {
      pad = "0";
    }
    var decimalLength = roundedSeconds.toString().replace(/^[0-9]+/, '').length;
    if(decimalLength == 0) {
      decimalPad = ".00";
    }
    else if(decimalLength == 2) {
      decimalPad = "0";
    }
    return minutes + ":" + pad + roundedSeconds + decimalPad;
  };
  
  ////////////////////////////////////
  //
  //       PLAYING TRACKS
  //
  ////////////////////////////////////
  
  // function to start playing a track by index
  playTrack = function (index) {
    stopPlaying();
    audioElement.remove();
    audioElement = document.createElement('audio');
    //audioElement.removeEventListener('ended', trackEnded(index), false);
    audioElement.setAttribute('src', URL.createObjectURL(audioFiles[index].file));
    audioElement.addEventListener('ended', function() {
      trackEnded(index);
    }, false);
    audioElement.play();
    $('#control'+index).html(buildStopButtonImage(index));
    currentlyPlaying = index;
  };
  
  // function called by clicking on play button for a specific track
  clickPlayTrack = function (index) {
    // don't allow click to play if currently playing whole side
    if(!isPlayingSide) {
      playTrack(index);
    }
  };
  
  stopPlaying = function () {
    if(currentlyPlaying > -1) {
      audioElement.pause();
      audioElement.currentTime = 0;
      $('#control'+currentlyPlaying).html(buildPlayButtonImage(currentlyPlaying));
      currentlyPlaying = -1;
      isPlayingSide = false;
    }
  };
  
  // function called by clicking on stop button for a specific track
  clickStopPlaying = function () {
    // don't allow click to stop if currently playing whole side
    if(!isPlayingSide) {
      stopPlaying();
    }
  };
  
  // call when a track ends to update button and stuff
  // TODO: will be used to trigger time wait and next playing track
  trackEnded = function (index) {
    if(currentlyPlaying == index) {
      console.log("track ended: " + index);
      $('#control'+index).html(buildPlayButtonImage(index));
      currentlyPlaying = -1;
      if(isPlayingSide) {
        currentTrack++;
        if(currentTrack >= sideTracks.length) {
          // just finished last track, don't wait for silence between tracks
          // call playNext immediately to initiate end of playing
          playNext();
        }
        else {
          // wait and then play the next track
          setTimeout(function() {
            playNext();
          }, Math.max((secondsSilence * 1000) - currentTimeOffset, 0));
        }
      }
    }
    else {
      console.log("leftover event listener that should have been removed");
      // leftover event listener that should have been removed
    }
  };
  
  playSideA = function () {
    if(!isPlayingSide && audioFiles.length > 0 && currentlyPlaying == -1) {
      console.log("playing side A with number of tracks: " + bestSolution.trackIdsA.length);
      currentSide = "A";
      sideTracks = bestSolution.trackIdsA;
      times = timesSideA;
      endTime = endTimeA;
      currentTrack = 0;
      currentTimeOffset = 0;
      currentFillWidth = parseInt($('#tapeFilledBarA').css("width").replace('px', ''));
      $('#playSideA').hide();
      $('#stopSideA').show();
      isPlayingSide = true;
      startTime = window.performance.now();
      //startTime = new Date();
      
      setTimeout(function() {
        playNext();
      }, secondsPaddingStart * 1000);
    }
  };
  
  playSideB = function () {
    if(!isPlayingSide && audioFiles.length > 0 && currentlyPlaying == -1) {
      console.log("playing side B with number of tracks: " + bestSolution.trackIdsB.length);
      currentSide = "B";
      sideTracks = bestSolution.trackIdsB;
      times = timesSideB;
      endTime = endTimeB;
      currentTrack = 0;
      currentTimeOffset = 0;
      currentFillWidth = parseInt($('#tapeFilledBarB').css("width").replace('px', ''));
      $('#playSideB').hide();
      $('#stopSideB').show();
      isPlayingSide = true;
      startTime = window.performance.now();
      
      setTimeout(function() {
        playNext();
      }, secondsPaddingStart * 1000);
    }
  };
  
  stopSideA = function () {
    stopPlayingSide();
  };
  
  stopSideB = function () {
    stopPlayingSide();
  };
  
  playNext = function () {
    if(isPlayingSide) {
      var currentTime = window.performance.now() - startTime;
      var expectedTime = times[currentTrack];
      var difference = currentTime - expectedTime;
      currentTimeOffset = difference;
      console.log("playing currentTrack: " + currentTrack + " of " + sideTracks.length);
      if(currentTrack < sideTracks.length) {
        console.log("playing track: " + audioFiles[sideTracks[currentTrack]].file.name);
        console.log("start time: " + currentTime + ", expected start time: " + times[currentTrack] + ", difference: " + difference);
        playTrack(sideTracks[currentTrack]);
      }
      else {
        // done playing, wait for end time
        console.log("done playing, waiting for end padding... currentTime: " + currentTime);
        setTimeout(function() {
          stopPlayingSide();
        }, secondsPaddingEnd * 1000);
      }
    }
  };
  
  stopPlayingSide = function () {
    if(isPlayingSide) {
      var currentTime = window.performance.now() - startTime;
      console.log("stopped playing at: " + currentTime);
      $('#control'+currentlyPlaying).html(buildPlayButtonImage(currentlyPlaying));
      isPlayingSide = false;
      currentSide = "";
      sideTracks = [];
      times = [];
      endTime = 0;
      currentTrack = 0;
      currentTimeOffset = 0;
      currentFillWidth = 0;
      $('#playSideA').show();
      $('#stopSideA').hide();
      $('#playSideB').show();
      $('#stopSideB').hide();
      audioElement.pause();
      audioElement.currentTime = 0;
      currentlyPlaying = -1;
      $('#timerA').text(formatTimeDecimal(0));
      $('#timerB').text(formatTimeDecimal(0));
      $('#tapePositionA').css('margin-left', '');
      $('#tapePositionB').css('margin-left', '');
    }
  };
  
  hideControlButtons = function () {
    $('#playSideA').hide();
    $('#stopSideA').hide();
    $('#playSideB').hide();
    $('#stopSideB').hide();
  };
  
  // update timer display
  var timerDisplay = setInterval(function () {
    if(isPlayingSide) {
      var currentTime = window.performance.now() - startTime;
      //console.log(currentTime);
      // don't allow displayed time to go higher than end time displayed for the side
      var displayTime = Math.min(currentTime/1000, endTime);
      $('#timer'+getSide()).text(formatTimeDecimal(displayTime));
      
      // update progress bar
      var percentDone = Math.min((currentTime/1000) / endTime, 1);
      $('#tapePosition'+getSide()).css('margin-left', percentDone * currentFillWidth);
    }
  }, 50);

  getSide = function () {
    if(isPlayingSide) {
      return currentSide;
    }
    return "";
  };
  
  moveTrackUp = function (index) {
    if(!isPlayingSide && index < audioFiles.length && bestSolution.trackIdsA.length > 0) {
      var moved = false;
      var trackPositionA = bestSolution.trackIdsA.indexOf(index);
      var trackPositionB = bestSolution.trackIdsB.indexOf(index);
      if(trackPositionA > 0) {
        // only move up if track is in list (not -1) and not the first element (not 0)
        
        // set current element (value is input index) to previous element value
        bestSolution.trackIdsA[trackPositionA] = bestSolution.trackIdsA[trackPositionA - 1];
        
        // set previous element value to input index
        bestSolution.trackIdsA[trackPositionA - 1] = index;
        
        moved = true;
      }
      else if(trackPositionB > 0) {
        bestSolution.trackIdsB[trackPositionB] = bestSolution.trackIdsB[trackPositionB - 1];
        bestSolution.trackIdsB[trackPositionB - 1] = index;
        moved = true;
      }
      
      if(moved) {
        displaySolution(bestSolution);
      }
    }
  };
  
  moveTrackDown = function (index) {
    if(!isPlayingSide && index < audioFiles.length && bestSolution.trackIdsA.length > 0) {
      var moved = false;
      var trackPositionA = bestSolution.trackIdsA.indexOf(index);
      var trackPositionB = bestSolution.trackIdsB.indexOf(index);
      if(trackPositionA > -1 && trackPositionA < bestSolution.trackIdsA.length - 1) {
        // only move down if track is in list (not -1) and not the last element (not length - 1)
        
        // set current element (value is input index) to next element value
        bestSolution.trackIdsA[trackPositionA] = bestSolution.trackIdsA[trackPositionA + 1];
        
        // set next element value to input index
        bestSolution.trackIdsA[trackPositionA + 1] = index;
        
        moved = true;
      }
      else if(trackPositionB > -1 && trackPositionB < bestSolution.trackIdsB.length - 1) {
        bestSolution.trackIdsB[trackPositionB] = bestSolution.trackIdsB[trackPositionB + 1];
        bestSolution.trackIdsB[trackPositionB + 1] = index;
        moved = true;
      }
      
      if(moved) {
        displaySolution(bestSolution);
      }
    }
  };
  
  
  ////////////////////////////////////
  //
  //       BRUTE FORCE LOGIC
  //
  ////////////////////////////////////
  
  // may want to add wasted time property
  function Solution () {
    this.trackIdsA = [];
    this.trackIdsB = [];
    this.duration = 0;
  }
  
  optimize = function () {
    if(audioFiles.length > 0) {
      secondsSideA = parseInt($('#minutesSideA').val()*100) * 60 / 100;
      secondsSideB = parseInt($('#minutesSideB').val()*100) * 60 / 100;
      secondsSilence = Math.max(parseInt($('#secondsSilence').val()), minimumSilence);
      secondsPaddingStart = parseInt($('#secondsPaddingStart').val());
      secondsPaddingEnd = parseInt($('#secondsPaddingEnd').val());
      maxTrackCount = getMaxTrackCount();
      minTrackCount = getMinTrackCount();
      solutionThreshold = parseInt($('#secondsThreshold').val());
      ignoreStupidSolutions = $('#stupidCheckbox').prop("checked");
      
      var maxSolutions = 0;
      var stupidSolutions = 0;
      
      if(minTrackCount == audioFiles.length) {
        // all tracks can fit on side 1
        bestSolution = getAllSolution();
      }
      else if(audioFiles.length > 20) {
        // too many solutions to try them all, using random mode
        maxSolutions = 1000000;
        bestSolution = getSolutionById(0);
        for(var i = 0; i < maxSolutions; i++) {
          var solutionId = Math.random() * Math.pow(2, audioFiles.length);
          if(!isStupidSolution(solutionId)) {
            var solution = getSolutionById(solutionId);
            if(solution.duration > bestSolution.duration && solution.duration <= secondsSideA) {
              bestSolution = solution;
              if(solution.duration >= secondsSideA - solutionThreshold) {
                console.log("stopping after " + i + " iterations out of " + maxSolutions);
                i = maxSolutions;
              }
            }
          }
          else {
            stupidSolutions++;
          }
        }
      }
      else {
        // brute forcing all solutions (up to 2^20=1048576 iterations)
        maxSolutions = Math.pow(2, audioFiles.length);
        bestSolution = getSolutionById(0);

        for(var i = 0; i < maxSolutions; i++) {
          if(!isStupidSolution(i)) {
            var solution = getSolutionById(i);
            if(solution.duration > bestSolution.duration && solution.duration <= secondsSideA) {
              bestSolution = solution;
              if(solution.duration >= secondsSideA - solutionThreshold) {
                console.log("stopping after " + i + " iterations out of " + maxSolutions);
                i = maxSolutions;
              }
            }
          }
          else {
            stupidSolutions++;
          }
        }
      }
      console.log("Best Solution: " + formatTimeDecimal(bestSolution.duration) + " (" + bestSolution.duration + ")");
      if(ignoreStupidSolutions) {
        console.log("Stupid solutions eliminated: " + stupidSolutions);
      }
      //print solution
      displaySolution(bestSolution);
      $('#results').show();
    }
  };
  
  // takes integer number
  // creates solution matching binary representation of tracks
  getSolutionById = function (id) {
    var solution = new Solution();
    // 5 -> 101 -> tracks 1, 3
    var binary = parseInt(id).toString(2);
    
    for(; binary.length < audioFiles.length;) {
      binary = "0" + binary;
    }
    
    var j = 0;
    for(var i = binary.length - 1; i >= 0; i--) {
      var current = binary.charAt(i);
      if(current == "1") {
        solution.trackIdsA.push(j);
      }
      else {
        solution.trackIdsB.push(j);
      }
      j++;
    }
    
    calculateDuration(solution);
    
    return solution;
  };
  
  getAllSolution = function () {
    var solution = new Solution();
    $.each(audioFiles, function (i, data) {
      solution.trackIdsA.push(i);
    });
    
    calculateDuration(solution);
    return solution;
  };
  
  // takes a solution, reads tracks on side A and saves duration to solution
  calculateDuration = function (solution) {
    var totalDuration = 0;
    
    // add in silence at start and end of tape
    totalDuration += secondsPaddingStart + secondsPaddingEnd;
    
    // add in silence between tracks
    totalDuration += secondsSilence * (solution.trackIdsA.length - 1);
    
    // add total track duration
    $.each(solution.trackIdsA, function (i, data) {
      totalDuration += audioFiles[data].duration;
    });
    
    // set solution duration to calculated duration
    solution.duration = totalDuration;
  };
  
  // returns true if this ID has more "1"s than the max possible or fewer than the min
  isStupidSolution = function (id) {
    if(ignoreStupidSolutions) {
      // check if too many or too few tracks
      
      // fast regex solution
      var binary = parseInt(id).toString(2);
      const pattern = new RegExp('^0*(10*){'+minTrackCount+','+maxTrackCount+'}$');
      return !pattern.test(binary);

      // slooooooow
      //var numTracks = (binary.split("1").length - 1);
      //return (numTracks > maxTrackCount || numTracks < minTrackCount);
    }
    return false;
  };
  
  clearSolution = function () {
    $('#resultSection').empty();
    $('#resultSectionA').empty();
    $('#resultSectionB').empty();
    var header = "<tr><th>Track Name</th><th>Duration</th><th>Side</th></tr>";
    var headerAB = "<tr><th></th><th>Track Name</th><th>Duration</th></tr>";
    $('#resultSection').append(header);
    $('#resultSectionA').append(headerAB);
    $('#resultSectionB').append(headerAB);
    sideA = [];
    sideB = [];
    timesSideA = [];
    timesSideB = [];
    endTimeA = 0;
    endTimeB = 0;
    endTime = 0;
  };
  
  displaySolution = function (solution) {
    clearSolution();
    
    var durationSideB = 0;
    
    $.each(solution.trackIdsA, function (i, data) {
      var track = audioFiles[data];
      
      //var arrows = '<span class="upArrow unselectable" onclick="moveTrackUp('+data+');">UP</span><span class="downArrow unselectable" onclick="moveTrackDown('+data+');">DN</span>';
      var arrows = '<span class="unselectable">' + buildUpArrowImage(data, i==0) + buildDownArrowImage(data, i==solution.trackIdsA.length-1) + '</span>';
      var dur = formatTimeDecimal(track.duration);
      //var row = "<tr><td>"+arrows+"</td><td>"+track.name+"</td><td>"+dur+"</td><td>"+side+"</td></tr>";
      //$('#resultSection').append(row);
      
      var splitRow = "<tr><td>"+arrows+"</td><td>"+track.name+"</td><td>"+dur+"</td></tr>";
      $('#resultSectionA').append(splitRow);
      sideA.push(i);
    });
    
    $.each(solution.trackIdsB, function (i, data) {
      var track = audioFiles[data];
      
      durationSideB += track.duration;
      //var arrows = '<span onclick="moveTrackUp('+data+');">UP</span>';
      var arrows = '<span class="unselectable">' + buildUpArrowImage(data, i==0) + buildDownArrowImage(data, i==solution.trackIdsB.length-1) + '</span>';
      var dur = formatTimeDecimal(track.duration);
      //var row = "<tr><td>"+arrows+"</td><td>"+track.name+"</td><td>"+dur+"</td><td>"+side+"</td></tr>";
      //$('#resultSection').append(row);
      
      var splitRow = "<tr><td>"+arrows+"</td><td>"+track.name+"</td><td>"+dur+"</td></tr>";
      $('#resultSectionB').append(splitRow);
      sideB.push(i);
    });
    /*
    $.each(audioFiles, function (i, data) {
      var side = "B";
      if(solution.trackIdsA.indexOf(i) != -1) {
        side = "A";
      }
      else {
        durationSideB += data.duration;
      }
      var arrows = '<span onclick="moveTrackUp('+i+');">UP</span>';
      var dur = formatTimeDecimal(data.duration);
      var row = "<tr><td>"+arrows+"</td><td>"+data.name+"</td><td>"+dur+"</td><td>"+side+"</td></tr>";
      $('#resultSection').append(row);
      
      var splitRow = "<tr><td>"+data.name+"</td><td>"+dur+"</td></tr>";
      if(side == "A") {
        $('#resultSectionA').append(splitRow);
        sideA.push(i);
      }
      else {
        $('#resultSectionB').append(splitRow);
        sideB.push(i);
      }
    });*/
    
    timesSideA = calculateTrackTimes(solution.trackIdsA);
    timesSideB = calculateTrackTimes(solution.trackIdsB);
    
    endTimeA = solution.duration;
    endTimeB = durationSideB;
    
    $('#titleSideA').text("Side A - " + bestSolution.trackIdsA.length + " Track" + (bestSolution.trackIdsA.length != 1 ? "s":"") + " - " + formatTimeDecimal(endTimeA));
    $('#titleSideB').text("Side B - " + bestSolution.trackIdsB.length + " Track" + (bestSolution.trackIdsB.length != 1 ? "s":"") + " - " + formatTimeDecimal(endTimeB));
    
    var percentFullA = endTimeA / secondsSideA;
    var percentFullB = endTimeB / secondsSideB;
    
    console.log("percent full side A: " + percentFullA);
    
    // update width of bar to show how full the tape is
    $('#tapeFilledBarA').css("width", percentFullA * 300);
    $('#tapeFilledBarB').css("width", percentFullB * 300);
    
    // show play buttons
    if(solution.trackIdsA.length > 0) {
      $('#playSideA').show();
    }
    if(solution.trackIdsB.length > 0) {
      $('#playSideB').show();
    }
    
    $('#resultCombined').hide();
  };
  
  // calculates expected start time in millis since pressing play side
  calculateTrackTimes = function (tracks) {
    var result = [];
    var time = 0; // adds up for each track
    time += (secondsPaddingStart * 1000);
    $.each(tracks, function (i, trackIndex) {
      result.push(time);
      time += (audioFiles[trackIndex].duration * 1000);
      time += (secondsSilence * 1000);
    });
    return result;
  };
  
  getMinTrackCount = function () {
    var sortedTracks = audioFiles.slice().sort(compareTracks);
    console.log("sorting tracks largest to smallest");
    var totalSeconds = 0;
    totalSeconds += secondsPaddingStart + secondsPaddingEnd;
    var maxSeconds = secondsSideA;
    var i = 0;
    for(; i < sortedTracks.length && totalSeconds < maxSeconds; i++) {
      //console.log("sorted track duration: " + sortedTracks[i].duration);
      totalSeconds += sortedTracks[i].duration;
      if(i > 0) {
        totalSeconds += secondsSilence;
      }
    }
    if(totalSeconds < maxSeconds) {
      console.log("min number of tracks: " + sortedTracks.length);
      return sortedTracks.length;
    }
    else {
      console.log("min number of tracks: " + (i-1));
      return (i-1);
    }
  };
  
  getMaxTrackCount = function () {
    var sortedTracks = audioFiles.slice().sort(compareTracks).reverse();
    console.log("sorting tracks smallest to largest");
    var totalSeconds = 0;
    totalSeconds += secondsPaddingStart + secondsPaddingEnd;
    var maxSeconds = secondsSideA;
    var i = 0;
    for(; i < sortedTracks.length && totalSeconds < maxSeconds; i++) {
      //console.log("sorted track duration: " + sortedTracks[i].duration);
      totalSeconds += sortedTracks[i].duration;
      if(i > 0) {
        totalSeconds += secondsSilence;
      }
    }
    if(totalSeconds < maxSeconds) {
      console.log("min number of tracks: " + sortedTracks.length);
      return sortedTracks.length;
    }
    else {
      console.log("max number of tracks: " + (i-1));
      return (i-1);
    }
  };
  
  // sorting tracks by length
  compareTracks = function (a, b) {
    return b.duration - a.duration;
  };
  
  hideControlButtons();
});
</script>
    <style class="silex-inline-styles" type="text/css">.body-initial {background-color: rgba(46,32,55,1); position: static;}.silex-id-1478366444112-1 {background-color: transparent; position: static; margin-top: -1px;}.silex-id-1478366444112-0 {background-color: transparent; min-height: 433px; position: relative; margin-left: auto; margin-right: auto;}.silex-id-1474394621033-3 {position: static; margin-top: -1px;}.silex-id-1474394621032-2 {background-color: transparent; min-height: 600px; position: relative; margin-left: auto; margin-right: auto;}.silex-id-1478366450713-3 {background-color: transparent; position: static; margin-top: -1px;}.silex-id-1478366450713-2 {background-color: transparent; min-height: 100px; position: relative; margin-left: auto; margin-right: auto;}.silex-id-1442914737143-3 {width: 241px; top: 26px; left: 494px; min-height: 51px; position: absolute;}.silex-id-1631411431091-0 {width: 352px; height: 221px; position: static; background-color: transparent;}.silex-id-1631459713093-2 {width: 908px; min-height: 190px; background-color: rgb(255, 255, 255); position: absolute; top: 386px; left: -1.34356689453125px;}.silex-id-1631460819517-4 {width: 1200px; min-height: 573px; background-color: rgb(255, 255, 255); position: absolute; top: -207px; left: -1.34356689453125px;}@media only screen and (max-width: 480px) {}</style>
    <title></title>
    

    
<style class="silex-prodotype-style" type="text/css" data-style-id="all-style">.text-element > .silex-element-content {font-family: 'Roboto', sans-serif;}</style><link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet" class="silex-custom-font"><meta name="viewport" content="width=device-width, initial-scale=1"><style type="text/css" class="silex-style-settings">.website-width {width: 1200px;}@media (min-width: 481px) {.silex-editor {min-width: 1400px;}}</style></head>

<body data-silex-id="body-initial" class="body-initial all-style enable-mobile prevent-resizable prevent-selectable editable-style silex-runtime" data-silex-type="container-element" style="">
    









    <section data-silex-type="container-element" class="container-element editable-style silex-id-1478366444112-1 section-element prevent-resizable" data-silex-id="silex-id-1478366444112-1" style="">
        <div data-silex-type="container-element" class="editable-style silex-element-content silex-id-1478366444112-0 container-element website-width" data-silex-id="silex-id-1478366444112-0" style=""><div data-silex-type="image-element" class="editable-style image-element silex-id-1631411431091-0 page-page-1 paged-element" data-silex-id="silex-id-1631411431091-0" style=""><img src="cassette-2760483_1920.png"></div></div>
    </section>
    <section data-silex-type="container-element" class="container-element editable-style silex-id-1474394621033-3 section-element prevent-resizable" data-silex-id="silex-id-1474394621033-3" style="">
        <div data-silex-type="container-element" class="editable-style silex-element-content silex-id-1474394621032-2 container-element website-width selected" data-silex-id="silex-id-1474394621032-2"><div data-silex-type="html-element" class="editable-style html-element silex-id-1631459713093-2 page-page-1 paged-element" data-silex-id="silex-id-1631459713093-2" style=""><div class="silex-element-content"><div>
        <input type="file" multiple="" id="fileInput">
        <button id="upload" onclick="upload();">Upload Tracks</button>
</div>

<div class="padded10">
    <label>Tape Length:</label>
        <select name="cars" id="cars">
            <option value="60">C60</option>
            <option value="90">C90</option>
            <option value="100">C100</option>
            <option value="110">C110</option>
            <option value="120">C120</option>
        </select>
</div>

<div class="padded10">
    <label>Side B Length (minutes):</label>
    <input type="number" id="minutesSideB" value="45" min="0" style="width: 40px;">
</div>

<div class="padded10">
    <label>Padding at Start of Tape (seconds):</label>
    <input type="number" id="secondsPaddingStart" value="0" min="0" style="width: 40px;">
</div>

<div class="padded10">
    <label>Padding at End of Tape (seconds):</label>
    <input type="number" id="secondsPaddingEnd" value="0" min="0" style="width: 40px;">
</div>

<div class="padded10">
    <label>Threshold for "good enough" solution (seconds):</label>
    <input type="number" id="secondsThreshold" value="5" min="0" style="width: 40px;">
    <label class="small"><i>Note: set to 0 to force optimal up to 1M iterations (may affect performance!)</i></label>
</div>

<label for="stupidCheckbox">Ignore Stupid Solutions</label>
    <input type="checkbox" name="stupidCheckbox" id="stupidCheckbox">
</div></div><div data-silex-type="html-element" class="editable-style html-element silex-id-1631460819517-4 page-page-1 paged-element" data-silex-id="silex-id-1631460819517-4" style=""><div class="silex-element-content">

  
    <title>Cassette Tape Maker</title>
    <link rel="shortcut icon" type="image/ico" href="favicon.ico">
    <link rel="stylesheet" type="text/css" href="tape.css">
  
  
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
    <!--<script type="text/javascript" src="audio-metadata-0.3.0/audio-metadata.min.js"></script>-->
    <script src="tape.js"></script>
    <div class="wrapper">
    
    <div class="content">
    <div class="titles">
    <div class="section topbanner">
      <div class="bannertext giant unselectable bold mono">
        Cassette Maker
      </div>
      <div class="bannerdesc medium unselectable mono">
        <i>Optimize Cassette Tapes</i>
      </div>
      <div class="dcopelogo bold mono red unselectable">
        <img src="andrewthomaspizza10.png" alt="andrewthomaspizza" style="width:200px;height:22px;">
      </div>
      <div class="tapelogo bold mono red unselectable">
        <img src="favicon.ico" alt="andrewthomaspizza" style="width:100px;height:100px;">
      </div>
    </div>
    <div class="section">
      <div>
        <input type="file" multiple="" id="fileInput">
        <button id="upload" onclick="upload();">Upload Tracks</button>
      </div>
      <div class="padded10">
        <label>Side A Length (minutes):</label>
        <input type="number" id="minutesSideA" value="45" min="0" style="width: 40px;">
      </div>
      <div class="padded10">
        <label>Side B Length (minutes):</label>
        <input type="number" id="minutesSideB" value="45" min="0" style="width: 40px;">
      </div>
      <div class="padded10">
        <label>Time Between Each Track (seconds):</label>
        <input type="number" id="secondsSilence" value="0" min="0" style="width: 40px;">
        <label class="small"><i>Note: minimum time is 0.1s</i></label>
      </div>
      <div class="padded10">
        <label>Padding at Start of Tape (seconds):</label>
        <input type="number" id="secondsPaddingStart" value="0" min="0" style="width: 40px;">
      </div>
      <div class="padded10">
        <label>Padding at End of Tape (seconds):</label>
        <input type="number" id="secondsPaddingEnd" value="0" min="0" style="width: 40px;">
      </div>
      <div class="padded10">
        <label>Threshold for "good enough" solution (seconds):</label>
        <input type="number" id="secondsThreshold" value="5" min="0" style="width: 40px;">
        <label class="small"><i>Note: set to 0 to force optimal up to 1M iterations (may affect performance!)</i></label>
      </div>
      <label for="stupidCheckbox">Ignore Stupid Solutions</label>
      <input type="checkbox" name="stupidCheckbox" id="stupidCheckbox">
    </div>
    <div class="section">
      <table id="fileListSection">
        <tbody><tr><th></th><th>Track Name</th><th>Duration</th><th></th></tr>
      </tbody></table>
      <div>
        <button id="optimize" onclick="optimize();">Optimize</button>
      </div>
    </div>
    <div id="results">
      <div id="resultCombined" class="section">
        <div class="padded10">
          Optimized Tape Sides
        </div>
        <table id="resultSection">
          <tbody><tr><th>Track Name</th><th>Duration</th><th>Side</th></tr>
        </tbody></table>
      </div>
      <div class="splitSection">
        <div id="resultSideA" class="section">
          <div id="titleSideA" class="bold medium">Side A</div>
          <div id="tapeSizeBarA" class="progressBar">
            <div id="tapePositionA" class="barPosition"></div>
            <div id="tapeFilledBarA" class="filledBar"></div>
          </div>
          <div class="tapeControls">
            <img id="playSideA" src="play_button_green3.png" alt="play" onclick="playSideA();" style="width:20px; height:20px;">
            <img id="stopSideA" src="stop_button_red3.png" alt="stop" onclick="stopSideA();" style="width:20px; height:20px;">
            <label id="timerA" class="timer mono bold">0:00.00</label>
          </div>
          <table id="resultSectionA" class="trackListingTable">
            <tbody><tr><th>Track Name</th><th>Duration</th></tr>
          </tbody></table>
        </div>
        <div id="resultSideB" class="section">
          <div id="titleSideB" class="bold medium">Side B</div>
          <div id="tapeSizeBarB" class="progressBar">
            <div id="tapePositionB" class="barPosition"></div>
            <div id="tapeFilledBarB" class="filledBar"></div>
          </div>
          <div class="tapeControls">
            <img id="playSideB" src="play_button_green3.png" alt="play" onclick="playSideB();" style="width:20px; height:20px;">
            <img id="stopSideB" src="stop_button_red3.png" alt="stop" onclick="stopSideB();" style="width:20px; height:20px;">
            <label id="timerB" class="timer mono bold">0:00.00</label>
          </div>
          <table id="resultSectionB" class="trackListingTable">
            <tbody><tr><th>Order</th><th>Track Name</th><th>Duration</th></tr>
          </tbody></table>
        </div>
        <br style="clear:both;">
      </div>
    </div>
    <div class="footer">
      <div>
        <div class="unselectable">
          <br>This site is 100% ad-free. I use an ad blocker, and you should too.
          <br>This page was designed to be viewed in Google Chrome. If you use another browser, <a target="_blank" href="https://www.google.com/chrome/browser/">click here to meet hot singles in your area</a>.
        </div>
        <div class="dcopelogo bold mono red unselectable">
          <img src="andrewthomaspizza10.png" alt="andrewthomaspizza" style="width:200px;height:22px;">
        </div>
      </div>
    </div>
    </div>
    </div>
  
</div></div></div></div>
    </section>
    <section data-silex-type="container-element" class="container-element editable-style silex-id-1478366450713-3 section-element prevent-resizable" data-silex-id="silex-id-1478366450713-3" style="">
        <div data-silex-type="container-element" class="editable-style silex-element-content silex-id-1478366450713-2 container-element website-width" data-silex-id="silex-id-1478366450713-2">

            <div data-silex-id="silex-id-1442914737143-3" class="editable-style silex-id-1442914737143-3 text-element" data-silex-type="text-element" style="">
                <div class="silex-element-content normal"><p>Powered by <a href="https://www.silex.me/" target="_blank" title="Silex website builder,  free and open source" linktype="LinkTypeExternal">Silex website builder</a></p></div>
            </div>
        </div>
    </section>
















</body></html>